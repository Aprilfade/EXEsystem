# åç«¯å¯†ç é•¿åº¦éªŒè¯åŠŸèƒ½å®æ–½æŠ¥å‘Š

## ä¸€ã€åŠŸèƒ½æ¦‚è¿°

**éœ€æ±‚**: åç«¯å¼ºåˆ¶æ–°æ³¨å†Œç”¨æˆ·å¯†ç é•¿åº¦â‰¥6ä½

**å®æ–½èŒƒå›´**: æ‰€æœ‰æ¶‰åŠå­¦ç”Ÿå¯†ç åˆ›å»ºå’Œä¿®æ”¹çš„åç«¯æ¥å£

## äºŒã€å·²å®æ–½çš„ä¿®æ”¹

### ä¿®æ”¹1: åˆ›å»ºå­¦ç”Ÿæ¥å£

**æ–‡ä»¶**: `BizStudentController.java` (Line 88-91)

**ä½ç½®**: `/api/v1/students` (POST)

**æ·»åŠ çš„éªŒè¯**:
```java
// âœ… æ–°å¢ï¼šå¯†ç é•¿åº¦éªŒè¯ï¼ˆè‡³å°‘6ä½ï¼‰
if (student.getPassword().length() < 6) {
    return Result.fail("å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½");
}
```

**è§¦å‘åœºæ™¯**:
- ç®¡ç†å‘˜åœ¨åå°æ‰‹åŠ¨æ·»åŠ å­¦ç”Ÿ
- å‰ç«¯è°ƒç”¨åˆ›å»ºå­¦ç”ŸAPI

**éªŒè¯æ—¶æœº**: åŠ å¯†ä¹‹å‰ï¼Œè®¾ç½®é»˜è®¤å¯†ç ä¹‹å

### ä¿®æ”¹2: å­¦ç”Ÿä¿®æ”¹å¯†ç æ¥å£

**æ–‡ä»¶**: `StudentAuthController.java` (Line 128-131)

**ä½ç½®**: `/api/v1/student/auth/update-password` (PUT)

**æ·»åŠ çš„éªŒè¯**:
```java
// âœ… æ–°å¢ï¼šå¯†ç é•¿åº¦éªŒè¯
if (newPassword == null || newPassword.length() < 6) {
    return Result.fail("æ–°å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½");
}
```

**è§¦å‘åœºæ™¯**:
- å­¦ç”Ÿåœ¨ä¸ªäººä¸­å¿ƒä¿®æ”¹å¯†ç 
- ä½¿ç”¨æ—§å¯†ç +æ–°å¯†ç çš„ä¿®æ”¹æ–¹å¼

**éªŒè¯æ—¶æœº**: éªŒè¯æ—§å¯†ç ä¹‹å‰

### ä¿®æ”¹3: å­¦ç”Ÿæ›´æ–°ä¸ªäººèµ„æ–™æ¥å£

**æ–‡ä»¶**: `StudentAuthController.java` (Line 167-170)

**ä½ç½®**: `/api/v1/student/auth/me` (PUT)

**æ·»åŠ çš„éªŒè¯**:
```java
// åªæœ‰å½“ç”¨æˆ·è¾“å…¥äº†æ–°å¯†ç æ—¶ï¼Œæ‰è¿›è¡ŒåŠ å¯†å’Œæ›´æ–°
if (studentUpdateData.getPassword() != null && !studentUpdateData.getPassword().isEmpty()) {
    // âœ… æ–°å¢ï¼šå¯†ç é•¿åº¦éªŒè¯
    if (studentUpdateData.getPassword().length() < 6) {
        return Result.fail("å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½");
    }
    studentToUpdate.setPassword(passwordEncoder.encode(studentUpdateData.getPassword()));
}
```

**è§¦å‘åœºæ™¯**:
- å­¦ç”Ÿåœ¨ä¸ªäººä¸­å¿ƒæ›´æ–°èµ„æ–™æ—¶åŒæ—¶ä¿®æ”¹å¯†ç 
- å‰ç«¯StudentProfile.vueè°ƒç”¨

**éªŒè¯æ—¶æœº**: ä»…å½“æä¾›äº†æ–°å¯†ç æ—¶éªŒè¯

### ä¿®æ”¹4: æ‰¹é‡å¯¼å…¥å­¦ç”Ÿ - æ›´æ–°ç°æœ‰å­¦ç”Ÿ

**æ–‡ä»¶**: `BizStudentServiceImpl.java` (Line 81-84)

**ä½ç½®**: `importStudents()` æ–¹æ³•å†…

**æ·»åŠ çš„éªŒè¯**:
```java
if (StringUtils.hasText(student.getPassword())) {
    // âœ… æ–°å¢ï¼šå¯†ç é•¿åº¦éªŒè¯
    if (student.getPassword().length() < 6) {
        throw new RuntimeException("å­¦å· " + student.getStudentNo() + " çš„å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½");
    }
    student.setPassword(passwordEncoder.encode(student.getPassword()));
}
```

**è§¦å‘åœºæ™¯**:
- ç®¡ç†å‘˜é€šè¿‡Excelæ‰¹é‡å¯¼å…¥å­¦ç”Ÿ
- Excelä¸­ä¸ºç°æœ‰å­¦ç”Ÿæä¾›äº†æ–°å¯†ç 

**éªŒè¯æ—¶æœº**: åŠ å¯†Excelä¸­æä¾›çš„æ–°å¯†ç ä¹‹å‰

### ä¿®æ”¹5: æ‰¹é‡å¯¼å…¥å­¦ç”Ÿ - æ–°å¢å­¦ç”Ÿ

**æ–‡ä»¶**: `BizStudentServiceImpl.java` (Line 95-107)

**ä½ç½®**: `importStudents()` æ–¹æ³•å†…

**æ·»åŠ çš„éªŒè¯**:
```java
// âœ… è®¾ç½®é»˜è®¤å¯†ç ï¼šå­¦å·å6ä½ï¼Œå¦‚æœä¸è¶³6ä½åˆ™ä½¿ç”¨"123456"
if (!StringUtils.hasText(student.getPassword())) {
    String studentNo = student.getStudentNo();
    String defaultPassword = studentNo.length() >= 6
            ? studentNo.substring(studentNo.length() - 6)
            : "123456";  // âœ… ä¿®æ”¹ï¼šä¸è¶³6ä½æ—¶ä½¿ç”¨é»˜è®¤å¯†ç 
    student.setPassword(defaultPassword);
}

// âœ… æ–°å¢ï¼šå¯†ç é•¿åº¦éªŒè¯
if (student.getPassword().length() < 6) {
    throw new RuntimeException("å­¦å· " + student.getStudentNo() + " çš„å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½");
}
```

**è§¦å‘åœºæ™¯**:
- ç®¡ç†å‘˜é€šè¿‡Excelæ‰¹é‡å¯¼å…¥æ–°å­¦ç”Ÿ
- Excelä¸­æœªæä¾›å¯†ç ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆ

**ä¼˜åŒ–æ”¹è¿›**:
- **ä¿®æ”¹å‰**: å­¦å·ä¸è¶³6ä½æ—¶ï¼Œä½¿ç”¨å­¦å·æœ¬èº«ï¼ˆå¯èƒ½<6ä½ï¼‰
- **ä¿®æ”¹å**: å­¦å·ä¸è¶³6ä½æ—¶ï¼Œä½¿ç”¨"123456"ä½œä¸ºé»˜è®¤å¯†ç 

## ä¸‰ã€å¯†ç éªŒè¯è§„åˆ™æ€»ç»“

| åœºæ™¯ | ä½ç½® | éªŒè¯è§„åˆ™ | é”™è¯¯æç¤º |
|------|------|---------|---------|
| åˆ›å»ºå­¦ç”Ÿ | BizStudentController | â‰¥6ä½ | "å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½" |
| ä¿®æ”¹å¯†ç  | StudentAuthController | â‰¥6ä½ | "æ–°å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½" |
| æ›´æ–°èµ„æ–™ | StudentAuthController | â‰¥6ä½ï¼ˆå¦‚æœæä¾›ï¼‰ | "å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½" |
| æ‰¹é‡å¯¼å…¥ï¼ˆæ›´æ–°ï¼‰ | BizStudentServiceImpl | â‰¥6ä½ | RuntimeException |
| æ‰¹é‡å¯¼å…¥ï¼ˆæ–°å¢ï¼‰ | BizStudentServiceImpl | â‰¥6ä½ | RuntimeException |

## å››ã€é»˜è®¤å¯†ç ç­–ç•¥

### ç­–ç•¥è¯´æ˜

**ä¼˜å…ˆçº§**:
1. **ç”¨æˆ·æä¾›å¯†ç ** â†’ ä½¿ç”¨ç”¨æˆ·æä¾›çš„å¯†ç ï¼ˆå¿…é¡»â‰¥6ä½ï¼‰
2. **å­¦å·â‰¥6ä½** â†’ ä½¿ç”¨å­¦å·å6ä½ä½œä¸ºé»˜è®¤å¯†ç 
3. **å­¦å·<6ä½** â†’ ä½¿ç”¨"123456"ä½œä¸ºé»˜è®¤å¯†ç 

### ç¤ºä¾‹

```java
å­¦å·: 2024001234 â†’ é»˜è®¤å¯†ç : 001234 (å­¦å·å6ä½)
å­¦å·: 2024       â†’ é»˜è®¤å¯†ç : 123456 (å›ºå®šå€¼)
å­¦å·: 20240      â†’ é»˜è®¤å¯†ç : 123456 (å›ºå®šå€¼ï¼Œé¿å…5ä½å¯†ç )
ç”¨æˆ·æä¾›: abc    â†’ é”™è¯¯: "å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½"
```

## äº”ã€å‰ç«¯é…åˆ

### å·²æœ‰çš„å‰ç«¯éªŒè¯

**æ–‡ä»¶**: `StudentProfile.vue` (Line 517)

```typescript
newPassword: [
    { required: true, message: 'è¯·è¾“å…¥æ–°å¯†ç ', trigger: 'blur' },
    { min: 6, message: 'å¯†ç é•¿åº¦è‡³å°‘6ä½', trigger: 'blur' }  // âœ… å‰ç«¯éªŒè¯
]
```

**åŒé‡ä¿æŠ¤**:
- âœ… å‰ç«¯éªŒè¯ï¼šæå‰æ‹¦æˆªï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- âœ… åç«¯éªŒè¯ï¼šå®‰å…¨ä¿éšœï¼Œé˜²æ­¢ç»•è¿‡å‰ç«¯

## å…­ã€å®‰å…¨æ€§æå‡

### ä¿®å¤å‰çš„é—®é¢˜

âŒ **å­¦å·å°‘äº6ä½æ—¶ï¼Œå¯†ç å¯èƒ½<6ä½**
```java
// é—®é¢˜ä»£ç 
String defaultPassword = studentNo.length() >= 6
    ? studentNo.substring(studentNo.length() - 6)
    : studentNo;  // å¦‚æœå­¦å·æ˜¯"2024"ï¼Œå¯†ç åªæœ‰4ä½ï¼
```

âŒ **æ— åç«¯éªŒè¯ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡APIåˆ›å»ºå¼±å¯†ç **
- å‰ç«¯éªŒè¯å¯ä»¥è¢«ç»•è¿‡
- æ¶æ„è¯·æ±‚å¯ä»¥åˆ›å»ºå¯†ç <6ä½çš„è´¦å·

### ä¿®å¤åçš„å®‰å…¨ä¿éšœ

âœ… **æ‰€æœ‰å¯†ç å¿…é¡»â‰¥6ä½**
- åˆ›å»ºå­¦ç”Ÿæ—¶éªŒè¯
- ä¿®æ”¹å¯†ç æ—¶éªŒè¯
- æ‰¹é‡å¯¼å…¥æ—¶éªŒè¯

âœ… **é»˜è®¤å¯†ç ç­–ç•¥ä¼˜åŒ–**
```java
// ä¿®å¤åä»£ç 
String defaultPassword = studentNo.length() >= 6
    ? studentNo.substring(studentNo.length() - 6)
    : "123456";  // ç¡®ä¿è‡³å°‘6ä½
```

âœ… **åŒé‡é˜²æŠ¤**
- å‰ç«¯ElementPlusè§„åˆ™éªŒè¯ï¼ˆç”¨æˆ·ä½“éªŒï¼‰
- åç«¯å¼ºåˆ¶éªŒè¯ï¼ˆå®‰å…¨ä¿éšœï¼‰

## ä¸ƒã€é”™è¯¯å¤„ç†

### APIè¿”å›é”™è¯¯æ ¼å¼

**åˆ›å»º/ä¿®æ”¹å¯†ç æ¥å£**:
```json
{
  "code": 500,
  "msg": "å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½",
  "data": null
}
```

**æ‰¹é‡å¯¼å…¥æ¥å£**:
- é‡åˆ°å¯†ç <6ä½æ—¶ï¼ŒæŠ›å‡ºRuntimeException
- å¯¼å…¥äº‹åŠ¡å›æ»šï¼Œæ•´ä¸ªæ‰¹æ¬¡å¤±è´¥
- é”™è¯¯ä¿¡æ¯åŒ…å«å…·ä½“å­¦å·ï¼š
```
å­¦å· 2024 çš„å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½
```

## å…«ã€æµ‹è¯•å»ºè®®

### æµ‹è¯•ç”¨ä¾‹1: åˆ›å»ºå­¦ç”Ÿ

```bash
# æµ‹è¯•1: å¯†ç â‰¥6ä½ï¼ˆæˆåŠŸï¼‰
POST /api/v1/students
{
  "studentNo": "2024001",
  "name": "æµ‹è¯•å­¦ç”Ÿ",
  "password": "123456"
}
æœŸæœ›: åˆ›å»ºæˆåŠŸ

# æµ‹è¯•2: å¯†ç <6ä½ï¼ˆå¤±è´¥ï¼‰
POST /api/v1/students
{
  "studentNo": "2024002",
  "name": "æµ‹è¯•å­¦ç”Ÿ",
  "password": "12345"
}
æœŸæœ›: {"code": 500, "msg": "å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½"}

# æµ‹è¯•3: æ— å¯†ç ï¼Œå­¦å·â‰¥6ä½ï¼ˆæˆåŠŸï¼‰
POST /api/v1/students
{
  "studentNo": "2024003",
  "name": "æµ‹è¯•å­¦ç”Ÿ"
}
æœŸæœ›: åˆ›å»ºæˆåŠŸï¼Œé»˜è®¤å¯†ç ä¸º"024003"

# æµ‹è¯•4: æ— å¯†ç ï¼Œå­¦å·<6ä½ï¼ˆæˆåŠŸï¼‰
POST /api/v1/students
{
  "studentNo": "2024",
  "name": "æµ‹è¯•å­¦ç”Ÿ"
}
æœŸæœ›: åˆ›å»ºæˆåŠŸï¼Œé»˜è®¤å¯†ç ä¸º"123456"
```

### æµ‹è¯•ç”¨ä¾‹2: ä¿®æ”¹å¯†ç 

```bash
# å­¦ç”Ÿä¿®æ”¹å¯†ç ï¼ˆæ–°å¯†ç <6ä½ï¼‰
PUT /api/v1/student/auth/update-password
{
  "oldPassword": "123456",
  "newPassword": "abc"
}
æœŸæœ›: {"code": 500, "msg": "æ–°å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½"}
```

### æµ‹è¯•ç”¨ä¾‹3: æ‰¹é‡å¯¼å…¥

**Excelå†…å®¹**:
| å­¦å· | å§“å | å¯†ç  |
|------|------|------|
| 2024001 | å¼ ä¸‰ | 123456 |
| 2024002 | æå›› | abc |

æœŸæœ›: å¯¼å…¥å¤±è´¥ï¼Œæç¤º"å­¦å· 2024002 çš„å¯†ç é•¿åº¦è‡³å°‘ä¸º6ä½"

## ä¹ã€ä»£ç ç»Ÿè®¡

| æ–‡ä»¶ | æ–°å¢ä»£ç  | è¯´æ˜ |
|------|---------|------|
| BizStudentController.java | +4è¡Œ | åˆ›å»ºå­¦ç”ŸéªŒè¯ |
| StudentAuthController.java | +8è¡Œ | ä¿®æ”¹å¯†ç éªŒè¯(2å¤„) |
| BizStudentServiceImpl.java | +12è¡Œ | æ‰¹é‡å¯¼å…¥éªŒè¯(2å¤„) + é»˜è®¤å¯†ç ä¼˜åŒ– |
| **æ€»è®¡** | **+24è¡Œ** | **5å¤„éªŒè¯** |

## åã€éƒ¨ç½²è¯´æ˜

### éœ€è¦é‡æ–°ç¼–è¯‘åç«¯

```bash
cd D:/Desktop/everything/EXEsystem/exe-backend
./mvnw clean compile -DskipTests
```

### å…¼å®¹æ€§è¯´æ˜

âœ… **å·²æœ‰è´¦å·ä¸å—å½±å“**
- å·²æ³¨å†Œçš„è´¦å·å¯†ç ä¸ä¼šè¢«å¼ºåˆ¶ä¿®æ”¹
- åªæœ‰æ–°æ³¨å†Œ/ä¿®æ”¹å¯†ç æ—¶æ‰éªŒè¯

âœ… **å‰ç«¯æ— éœ€ä¿®æ”¹**
- å‰ç«¯å·²æœ‰å¯†ç é•¿åº¦éªŒè¯ï¼ˆStudentProfile.vueï¼‰
- åç«¯éªŒè¯ä½œä¸ºé¢å¤–ä¿éšœ

## åä¸€ã€æ€»ç»“

æœ¬æ¬¡å®æ–½å®Œæˆäº†ä»¥ä¸‹ç›®æ ‡ï¼š

âœ… **å…¨é¢è¦†ç›–**: æ‰€æœ‰åˆ›å»ºå’Œä¿®æ”¹å¯†ç çš„æ¥å£éƒ½æ·»åŠ äº†éªŒè¯
âœ… **å®‰å…¨æå‡**: å¼ºåˆ¶å¯†ç â‰¥6ä½ï¼Œé˜²æ­¢å¼±å¯†ç 
âœ… **é»˜è®¤å¯†ç ä¼˜åŒ–**: å­¦å·<6ä½æ—¶ä½¿ç”¨å›ºå®šé»˜è®¤å¯†ç "123456"
âœ… **åŒé‡é˜²æŠ¤**: å‰ç«¯éªŒè¯+åç«¯éªŒè¯
âœ… **å‹å¥½æç¤º**: æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯

**å®æ–½ç»“æœ**:
- âœ… æ–°æ³¨å†Œç”¨æˆ·å¯†ç å¿…é¡»â‰¥6ä½
- âœ… ä¿®æ”¹å¯†ç å¿…é¡»â‰¥6ä½
- âœ… æ‰¹é‡å¯¼å…¥æ—¶å¯†ç å¿…é¡»â‰¥6ä½
- âœ… é»˜è®¤å¯†ç ç­–ç•¥æ›´åŠ å®‰å…¨

---

**å®æ–½æ—¶é—´**: 2026-01-11
**å®æ–½ç‰ˆæœ¬**: v3.10
**æ¶‰åŠæ–‡ä»¶**: 3ä¸ªJavaæ–‡ä»¶
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜ï¼ˆå®‰å…¨æ€§ï¼‰
**æµ‹è¯•çŠ¶æ€**: â³ å¾…æµ‹è¯•
