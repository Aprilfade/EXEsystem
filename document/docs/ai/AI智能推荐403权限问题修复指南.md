# AIæ™ºèƒ½æ¨è403æƒé™é—®é¢˜ä¿®å¤æŒ‡å—

## é—®é¢˜ç°è±¡

ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"åï¼Œå¯¹è¯æ¡†æ‰“å¼€äº†ï¼Œä½†æ˜¯æ˜¾ç¤ºé”™è¯¯ï¼š
```
GET http://localhost:5173/api/v1/questions/2283 403 (Forbidden)
è·å–é¢˜ç›®è¯¦æƒ…å¤±è´¥
```

## é—®é¢˜åŸå› 

å­¦ç”Ÿè´¦å·æ²¡æœ‰æƒé™è®¿é—®ç®¡ç†å‘˜æ¥å£ `/api/v1/questions/{id}`

## ä¿®å¤æ–¹æ¡ˆ

å·²åˆ›å»ºå­¦ç”Ÿç«¯ä¸“ç”¨çš„é¢˜ç›®è¯¦æƒ…æ¥å£ã€‚

### åç«¯ä¿®å¤

**æ–‡ä»¶**: `exe-backend/src/main/java/com/ice/exebackend/controller/BizQuestionController.java`

**æ–°å¢æ¥å£** (Line 359-376):

```java
/**
 * ã€æ–°å¢ã€‘å­¦ç”Ÿè·å–é¢˜ç›®è¯¦æƒ…ï¼ˆå…¬å¼€æ¥å£ï¼Œæ— éœ€ç®¡ç†å‘˜æƒé™ï¼‰
 */
@GetMapping("/practice/{id}")
@PreAuthorize("hasAuthority('ROLE_STUDENT')")
public Result getQuestionDetail(@PathVariable Long id) {
    logger.info("å­¦ç”Ÿè·å–é¢˜ç›®è¯¦æƒ…: questionId={}", id);

    BizQuestion question = questionService.getById(id);
    if (question == null) {
        logger.warn("é¢˜ç›®ä¸å­˜åœ¨: questionId={}", id);
        return Result.fail("é¢˜ç›®ä¸å­˜åœ¨");
    }

    logger.info("æˆåŠŸè·å–é¢˜ç›®è¯¦æƒ…: questionId={}", id);
    return Result.suc(question);
}
```

**æ¥å£ä¿¡æ¯**:
- **è·¯å¾„**: `GET /api/v1/questions/practice/{id}`
- **æƒé™**: `ROLE_STUDENT`
- **å‚æ•°**: `id` - é¢˜ç›®ID
- **è¿”å›**: é¢˜ç›®è¯¦æƒ…å¯¹è±¡

### å‰ç«¯ä¿®å¤

**æ–‡ä»¶**: `exe-frontend/src/components/ai/RecommendationPanel.vue`

**ä¿®æ”¹** (Line 293-297):

```typescript
// âœ… ä¿®æ”¹å‰
const res = await request({
  url: `/api/v1/questions/${questionId}`,  // âŒ ç®¡ç†å‘˜æ¥å£
  method: 'get'
});

// âœ… ä¿®æ”¹å
const res = await request({
  url: `/api/v1/questions/practice/${questionId}`,  // âœ… å­¦ç”Ÿç«¯æ¥å£
  method: 'get'
});
```

## éƒ¨ç½²æ­¥éª¤

### æ–¹æ³•1: ä½¿ç”¨Dockerï¼ˆæ¨èï¼‰

å¦‚æœæ‚¨ä½¿ç”¨Dockeréƒ¨ç½²ï¼š

```bash
cd D:\Desktop\everything\EXEsystem

# é‡æ–°æ„å»ºåç«¯é•œåƒ
docker-compose build exe-backend

# é‡å¯åç«¯æœåŠ¡
docker-compose restart exe-backend

# æŸ¥çœ‹æ—¥å¿—ç¡®è®¤å¯åŠ¨æˆåŠŸ
docker-compose logs -f exe-backend
```

### æ–¹æ³•2: æ‰‹åŠ¨ç¼–è¯‘å’Œå¯åŠ¨

#### æ­¥éª¤1: ç¼–è¯‘åç«¯

```bash
cd D:\Desktop\everything\EXEsystem\exe-backend

# Windowsä½¿ç”¨
mvnw.cmd clean package -DskipTests

# Linux/Macä½¿ç”¨
./mvnw clean package -DskipTests
```

#### æ­¥éª¤2: é‡å¯åç«¯åº”ç”¨

å¦‚æœä½¿ç”¨IDEï¼ˆIntelliJ IDEA / Eclipseï¼‰:
1. åœæ­¢å½“å‰è¿è¡Œçš„Spring Bootåº”ç”¨
2. é‡æ–°è¿è¡Œä¸»ç±» `ExeBackendApplication`

å¦‚æœä½¿ç”¨å‘½ä»¤è¡Œ:
```bash
# æ‰¾åˆ°Javaè¿›ç¨‹
jps

# åœæ­¢æ—§è¿›ç¨‹ï¼ˆæ›¿æ¢{PID}ä¸ºå®é™…è¿›ç¨‹IDï¼‰
taskkill /F /PID {PID}

# å¯åŠ¨æ–°è¿›ç¨‹
java -jar target/exe-backend-0.0.1-SNAPSHOT.jar
```

### æ–¹æ³•3: çƒ­éƒ¨ç½²ï¼ˆå¦‚æœé…ç½®äº†ï¼‰

å¦‚æœæ‚¨çš„é¡¹ç›®é…ç½®äº†Spring Boot DevToolsï¼Œåªéœ€ï¼š
1. ä¿å­˜ä¿®æ”¹çš„æ–‡ä»¶
2. ç­‰å¾…è‡ªåŠ¨é‡æ–°ç¼–è¯‘å’Œé‡å¯

### å‰ç«¯é‡å¯

```bash
cd D:\Desktop\everything\EXEsystem\exe-frontend

# åœæ­¢å¼€å‘æœåŠ¡å™¨ (Ctrl+C)

# æ¸…é™¤ç¼“å­˜
rm -rf node_modules/.vite

# é‡æ–°å¯åŠ¨
npm run dev
```

## æµ‹è¯•éªŒè¯

### æ­¥éª¤1: æµ‹è¯•åç«¯API

ä½¿ç”¨æµè§ˆå™¨æˆ–Postmanæµ‹è¯•æ–°æ¥å£ï¼š

```http
GET http://localhost:8080/api/v1/questions/practice/2283
Authorization: Bearer {å­¦ç”Ÿç«¯Token}
```

**é¢„æœŸå“åº”**:
```json
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ",
  "data": {
    "id": 2283,
    "content": "é¢˜ç›®å†…å®¹...",
    "options": "[\"A\", \"B\", \"C\", \"D\"]",
    "answer": "A",
    "description": "é¢˜ç›®è§£æ...",
    "questionType": 1,
    ...
  }
}
```

### æ­¥éª¤2: æµ‹è¯•å‰ç«¯åŠŸèƒ½

1. **æ¸…é™¤æµè§ˆå™¨ç¼“å­˜**
   - F12 â†’ Application â†’ Storage â†’ Clear site data
   - æˆ– Ctrl+Shift+Delete

2. **è®¿é—®å­¦ç”Ÿç«¯Dashboard**

3. **æ‰¾åˆ°AIæ™ºèƒ½æ¨èé¢æ¿**

4. **ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"æŒ‰é’®**

**é¢„æœŸç»“æœ** âœ…:
- å¯¹è¯æ¡†æ‰“å¼€
- æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- **æˆåŠŸåŠ è½½é¢˜ç›®è¯¦æƒ…**ï¼ˆé¢˜ç›®å†…å®¹ã€é€‰é¡¹ã€ç­”æ¡ˆã€è§£æï¼‰
- ä¸æ˜¾ç¤º403é”™è¯¯

**æˆåŠŸæ ‡å¿—**:
- æµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤º:
  ```
  æŸ¥çœ‹é¢˜ç›®è¯¦æƒ…: 2283
  æˆåŠŸè·å–é¢˜ç›®è¯¦æƒ…: questionId=2283
  ```
- Networkæ ‡ç­¾æ˜¾ç¤º:
  ```
  GET /api/v1/questions/practice/2283  200 OK
  ```

## æ•…éšœæ’æŸ¥

### é—®é¢˜1: åç«¯ç¼–è¯‘å¤±è´¥

**é”™è¯¯**: `ä¸æ”¯æŒå‘è¡Œç‰ˆæœ¬ 17`

**è§£å†³æ–¹æ³•**:

1. **æ£€æŸ¥Javaç‰ˆæœ¬**:
```bash
java -version
```
éœ€è¦ Java 17 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚

2. **è®¾ç½®JAVA_HOME**:
```bash
# Windows
set JAVA_HOME=C:\Program Files\Java\jdk-21

# Linux/Mac
export JAVA_HOME=/path/to/jdk-21

# éªŒè¯
echo $JAVA_HOME
```

3. **ä½¿ç”¨æ­£ç¡®çš„Javaç‰ˆæœ¬ç¼–è¯‘**:
```bash
# Windows
mvnw.cmd clean compile -DskipTests

# Linux/Mac
./mvnw clean compile -DskipTests
```

### é—®é¢˜2: ä»ç„¶æ˜¾ç¤º403é”™è¯¯

**æ£€æŸ¥æ¸…å•**:

- [ ] åç«¯æœåŠ¡æ˜¯å¦é‡å¯ï¼Ÿ
- [ ] æ–°æ¥å£æ˜¯å¦ç¼–è¯‘æˆåŠŸï¼Ÿ
- [ ] å‰ç«¯ä»£ç æ˜¯å¦ä¿®æ”¹ä¸º `/api/v1/questions/practice/{id}`ï¼Ÿ
- [ ] æµè§ˆå™¨ç¼“å­˜æ˜¯å¦æ¸…é™¤ï¼Ÿ
- [ ] æ˜¯å¦ä½¿ç”¨å­¦ç”Ÿè´¦å·ç™»å½•ï¼Ÿ

**è°ƒè¯•æ­¥éª¤**:

1. **æ£€æŸ¥åç«¯æ—¥å¿—**:
```bash
# Docker
docker-compose logs -f exe-backend | grep "å­¦ç”Ÿè·å–é¢˜ç›®è¯¦æƒ…"

# æˆ–æŸ¥çœ‹åº”ç”¨æ—¥å¿—æ–‡ä»¶
tail -f exe-backend/logs/application.log
```

2. **æ£€æŸ¥å‰ç«¯è¯·æ±‚**:
- F12 â†’ Network â†’ æ‰¾åˆ°è¯·æ±‚
- æŸ¥çœ‹Request URLæ˜¯å¦æ˜¯ `/api/v1/questions/practice/{id}`
- æŸ¥çœ‹Request Headersä¸­çš„Authorization

3. **æµ‹è¯•APIç›´æ¥è®¿é—®**:
```bash
# æ›¿æ¢{TOKEN}ä¸ºå®é™…çš„å­¦ç”Ÿç«¯Token
curl -H "Authorization: Bearer {TOKEN}" http://localhost:8080/api/v1/questions/practice/2283
```

### é—®é¢˜3: å¯¹è¯æ¡†æ‰“å¼€ä½†æ˜¾ç¤º"é¢˜ç›®ä¸å­˜åœ¨"

**åŸå› **: é¢˜ç›®IDä¸å­˜åœ¨äºæ•°æ®åº“ä¸­

**è§£å†³**:
- æ£€æŸ¥æ¨èè¿”å›çš„questionIdæ˜¯å¦æœ‰æ•ˆ
- æŸ¥è¯¢æ•°æ®åº“ç¡®è®¤é¢˜ç›®æ˜¯å¦å­˜åœ¨
- å¯èƒ½éœ€è¦é‡æ–°ç”Ÿæˆæ¨èæ•°æ®

### é—®é¢˜4: å¯¹è¯æ¡†æ˜¾ç¤ºä½†å†…å®¹ä¸ºç©º

**åŸå› **:
1. é¢˜ç›®æ•°æ®å­—æ®µä¸ºç©º
2. å‰ç«¯è§£æå¤±è´¥

**è§£å†³**:
- æ£€æŸ¥åç«¯è¿”å›çš„æ•°æ®ç»“æ„
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰JavaScripté”™è¯¯
- æ£€æŸ¥é€‰é¡¹è§£æé€»è¾‘ `parseOptions` å‡½æ•°

## å¿«é€Ÿä¿®å¤è„šæœ¬ï¼ˆå¯é€‰ï¼‰

### Windowsæ‰¹å¤„ç†è„šæœ¬

åˆ›å»º `restart-backend.bat`:

```batch
@echo off
echo åœæ­¢åç«¯æœåŠ¡...
taskkill /F /IM java.exe

echo ç¼–è¯‘åç«¯...
cd D:\Desktop\everything\EXEsystem\exe-backend
call mvnw.cmd clean package -DskipTests

echo å¯åŠ¨åç«¯æœåŠ¡...
start java -jar target\exe-backend-0.0.1-SNAPSHOT.jar

echo åç«¯æœåŠ¡é‡å¯å®Œæˆï¼
pause
```

### Linux/Mac Shellè„šæœ¬

åˆ›å»º `restart-backend.sh`:

```bash
#!/bin/bash

echo "åœæ­¢åç«¯æœåŠ¡..."
pkill -f exe-backend

echo "ç¼–è¯‘åç«¯..."
cd exe-backend
./mvnw clean package -DskipTests

echo "å¯åŠ¨åç«¯æœåŠ¡..."
nohup java -jar target/exe-backend-0.0.1-SNAPSHOT.jar &

echo "åç«¯æœåŠ¡é‡å¯å®Œæˆï¼"
```

## ä¿®å¤æ€»ç»“

| ä¿®æ”¹é¡¹ | æ–‡ä»¶ | å†…å®¹ |
|--------|------|------|
| **åç«¯æ–°å¢** | BizQuestionController.java | æ·»åŠ å­¦ç”Ÿç«¯é¢˜ç›®è¯¦æƒ…æ¥å£ |
| **å‰ç«¯ä¿®æ”¹** | RecommendationPanel.vue | ä¿®æ”¹APIè·¯å¾„ |
| **æƒé™** | å­¦ç”Ÿè´¦å· | ROLE_STUDENT |
| **æ¥å£è·¯å¾„** | æ–° | `/api/v1/questions/practice/{id}` |
| **æ¥å£è·¯å¾„** | æ—§ | `/api/v1/questions/{id}` (403) |

## é¢„æœŸæ•ˆæœå¯¹æ¯”

### ä¿®å¤å‰
```
ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"
  â†“
å¯¹è¯æ¡†æ‰“å¼€
  â†“
è¯·æ±‚ GET /api/v1/questions/2283
  â†“
âŒ 403 Forbidden
  â†“
æ˜¾ç¤º"è·å–é¢˜ç›®è¯¦æƒ…å¤±è´¥"
```

### ä¿®å¤å
```
ç‚¹å‡»"æŸ¥çœ‹è¯¦æƒ…"
  â†“
å¯¹è¯æ¡†æ‰“å¼€
  â†“
è¯·æ±‚ GET /api/v1/questions/practice/2283
  â†“
âœ… 200 OK
  â†“
æ˜¾ç¤ºé¢˜ç›®å†…å®¹ã€é€‰é¡¹ã€ç­”æ¡ˆã€è§£æ
```

## éªŒè¯æˆåŠŸçš„æ ‡å¿—

âœ… **å®Œå…¨æˆåŠŸ**:
1. å¯¹è¯æ¡†æ­£å¸¸æ‰“å¼€
2. æ˜¾ç¤º"åŠ è½½ä¸­..."åŠ¨ç”»
3. æˆåŠŸæ˜¾ç¤ºé¢˜ç›®è¯¦æƒ…
4. å¯ä»¥çœ‹åˆ°é¢˜ç›®å†…å®¹
5. å¯ä»¥çœ‹åˆ°é€‰é¡¹ï¼ˆå¦‚æœæ˜¯é€‰æ‹©é¢˜ï¼‰
6. å¯ä»¥çœ‹åˆ°å‚è€ƒç­”æ¡ˆ
7. å¯ä»¥çœ‹åˆ°é¢˜ç›®è§£æ
8. ç‚¹å‡»"å¼€å§‹ç»ƒä¹ "å¯ä»¥è·³è½¬åˆ°ç»ƒä¹ é¡µé¢

âœ… **æ§åˆ¶å°æ—¥å¿—**:
```
æŸ¥çœ‹é¢˜ç›®è¯¦æƒ…: 2283
(æ— 403é”™è¯¯)
```

âœ… **Networkæ ‡ç­¾**:
```
Request URL: http://localhost:8080/api/v1/questions/practice/2283
Status Code: 200 OK
Response: { "code": 200, "data": {...} }
```

---

**ä¿®å¤å®Œæˆæ—¶é—´**: 2026-01-11
**ä¿®å¤ç‰ˆæœ¬**: v3.10
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜
**æ¶‰åŠæ–‡ä»¶**:
- âœ… `exe-backend/src/main/java/com/ice/exebackend/controller/BizQuestionController.java`
- âœ… `exe-frontend/src/components/ai/RecommendationPanel.vue`

**éœ€è¦é‡å¯**:
- âœ… åç«¯æœåŠ¡ï¼ˆå¿…é¡»ï¼‰
- âœ… å‰ç«¯æœåŠ¡ï¼ˆå¿…é¡»ï¼‰
- âœ… æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼ˆå¿…é¡»ï¼‰
